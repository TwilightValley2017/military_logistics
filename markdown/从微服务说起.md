2023 技术规划之 - 微前端

微前端思想（架构理论）不是横空出世的，是微服务思想的衍生物，要理解微前端化的 Why 和 How，很难绕过微服务的诞生过程与思想

# 单体应用

终端应用
- 桌面客户端：Desktop Application
- 网页客户端：Web Application

## 阶段一 
终端应用，对应一台服务器

## 阶段二 
终端应用，对应多台服务器
- 客户端于服务器之间加入负载均衡

## 阶段三 
终端应用，对应多台服务器+CDN服务器
> CDN 诞生
> - 通过将内容分发到距离客户端较近的缓存服务器
> - Q: 通过什么来控制客户端的流量去向就近的CDN服务器？
> - A: 通过 CDN 专用 DNS 与 CDN 负载均衡服务器
> - 引入缓存策略

发展到这里，服务依然是单体应用的形式，一个单体应用随着业务增长与生命周期的持续，会面临
- 代码臃肿，应用启动时间长；（代码超过1G的项目都有！）
- 回归测试周期长，修复一个小小bug可能都需要对所有关键业务进行回归测试。
- 应用容错性差，某个小小功能的程序错误可能导致整个系统宕机；
- 伸缩困难，单体应用扩展性能时只能整个应用进行扩展，造成计算资源浪费。
- 开发协作困难，一个大型应用系统，可能几十个甚至上百个开发人员，大家都在维护一套代码的话，代码merge复杂度急剧增加。

# 微服务
- 是 SOA （面向服务架构）设计方法论的延续
- 解决业务领域问题为切入点，划分微服务边界（DDD）
- 能力可提供给其他微服务使用

> 什么是“面向XX”
> 
> 以“XX的方式”来看待事物
> 
> 例如，面向对象编程，以“对象的方式”来看待编程。
> - 以构建对象为目的，进行编程思考与设计
> - 呈现形态上，以对象为主要组成部分

# 微服务架构
- **治理**微服务为目的
- 微服务注册中心，微服务清单，微服务可注册/可被发现
- 配置中心，微服务配置的集中管理与下发

再深入就到服务端技术领域了，不扩展。

# 微前端
- 微服务的衍生物
- 通过微服务的诞生过程与特性，对前端应用的微前端化进行思考与度量


## 前端模块分析
目标模块，web-view/web-doc_preview
生命周期长，功能堆积，组件调用关系复杂，耦合度高，可扩展程度差

web-view
- 文件操作
- 权限管理
- 链接管理
- 消息统计管理
- 审批管理

应用规划
### 权限
- 类型：CBB 组件
- 范围：全局业务
- 业务稳定度：高

### 消息通知
- 类型：微应用
- 业务稳定度：低
- 接口
    - 消息类型
    - 消息内容
- 呈现：能够对其他微应用进行访问

> 思考：如何实现消息类型可扩展，如，消息模板组件化

### 链接管理
- 类型：微应用
- 业务稳定度：中
- 范围：链接详情
- 组件：创建链接组件

### 审批管理
- 类型：微应用
- 业务稳定度：中
- 范围：审批任务管理，审批详情
- 组件：创建审批组件

### 基座
- 类型：微应用
- 范围
    - 版面框架
    - 应用中心
    - 用户中心
> 思考
> 
> - 是否引入总线机制
> - 如何管理数据流
> - 如何管理用户缓存

### 生态
- CBB 在微应用中的清单
- 微应用配置手册
- CI 可扩展
- CD 流程可扩展


## 微前端应用组织方式

### 路由集成
什么适合路由
- view 模块拆分出的子应用

### 子应用以模块形式集成
什么适合模块形式

隔离的方式与实践/避坑
- 技术栈无关
- 独立开发、独立部署
    - 如何处理注册与发现的机制
- 增量升级
- 独立运行时
    - 如何处理数据与状态的共享，污染与追溯问题
    - 全局状态管理
    - 调试问题



> 扩展
> 
> 什么是动态代码执行
> 
> 沙箱机制
> 
> https://zhuanlan.zhihu.com/p/428039764
> 
> https://cloud.tencent.com/developer/article/1967595
> 


